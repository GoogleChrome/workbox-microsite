---
layout: jsdoc
title: "Class: Queue"
jsdocNav: 
  - Modules:
    - <a href="module-workbox-background-sync.html#main">workbox-background-sync</a>
    - <a href="module-workbox-broadcast-cache-update.html#main">workbox-broadcast-cache-update</a>
    - <a href="module-workbox-build.html#main">workbox-build</a>
    - <a href="module-workbox-cache-expiration.html#main">workbox-cache-expiration</a>
    - <a href="module-workbox-cacheable-response.html#main">workbox-cacheable-response</a>
    - <a href="module-workbox-google-analytics.html#main">workbox-google-analytics</a>
    - <a href="module-workbox-precaching.html#main">workbox-precaching</a>
    - <a href="module-workbox-routing.html#main">workbox-routing</a>
    - <a href="module-workbox-runtime-caching.html#main">workbox-runtime-caching</a>
    - <a href="module-workbox-sw.html#main">workbox-sw</a>
    - <a href="module-workbox-webpack-plugin.html#main">workbox-webpack-plugin</a>
    - <a href="workbox-range-requests%250A_%2520workbox-range-requests%250A%250AA%2520helper%2520library%2520that%2520instructs%2520a%2520service%2520worker%2520respond%2520to%2520HTTP%2520requests%250Athat%2520include%2520a%2520%255BRange_%255D(https___developer.mozilla.org_en-US_docs_Web_HTTP_Range_requests)%250Aheader%2520with%2520a%2520subset%2520of%2520a%2520full%2520response.%250A%250AIf%2520you%2520are%2520not%2520already%2520using%2520Workbox,%2520this%2520library%2520can%2520be%2520used%2520in%2520a%250Astandalone%2520form%2520via%250A%257B@link%2520handleRangeRequest_workbox.rangeRequests.handleRangeRequest%257D.%250A%250AIf%2520you%2520are%2520using%2520Workbox%2520for%2520routing%2520or%2520request%2520handling%2520already,%2520then%250A%257B@link%2520CacheRangeResponsePlugin%257D%2520will%2520offer%2520the%2520easiest%2520integration.%250A%250A__If%2520your%2520cached%2520resources%2520are%2520large,%2520use%2520caution%2520when%2520adding%2520this%2520library.%250ASome%2520browsers%2520need%2520to%2520read%2520the%2520entire%2520resource%2520into%2520memory%2520before%2520it%2520can%2520be%250Amodified%2520to%2520respond%2520to%2520the%2520request.__%250A%250AInspired%2520by%250A%250A-%2520https___github.com_jakearchibald_range-request-test_blob_master_static_sw.js%250A-%2520https___github.com_GoogleChrome_sample-media-pwa_blob_master_src_client_scripts_ranged-response.jsmodule_.html#main">workbox-range-requests
# workbox-range-requests

A helper library that instructs a service worker respond to HTTP requests
that include a [Range:](https://developer.mozilla.org/en-US/docs/Web/HTTP/Range_requests)
header with a subset of a full response.

If you are not already using Workbox, this library can be used in a
standalone form via
workbox.rangeRequests.handleRangeRequest.

If you are using Workbox for routing or request handling already, then
CacheRangeResponsePlugin will offer the easiest integration.

**If your cached resources are large, use caution when adding this library.
Some browsers need to read the entire resource into memory before it can be
modified to respond to the request.**

Inspired by

- https://github.com/jakearchibald/range-request-test/blob/master/static/sw.js
- https://github.com/GoogleChrome/sample-media-pwa/blob/master/src/client/scripts/ranged-response.js</a>
---







    
        <h2>Queue</h2>
        
            <p>Use the instance of this class to push the failed requests into the queue.</p>
        
    

    
      
          <h3>Example</h3>
          
    <pre class="prettyprint"><code>When you want to push the requests manually
let bgQueue = new workbox.backgroundSync.Queue();
self.addEventListener('fetch', function(e) {
  if (!e.request.url.startsWith('https://jsonplaceholder.typicode.com')) {
    return;
  }

  const clone = e.request.clone();
  e.respondWith(fetch(e.request).catch((err) => {
    bgQueue.pushIntoQueue({
      request: clone,
    });
    throw err;
  }));
});</code></pre>

      

      
        <h2 class="subsection-title">Constructor</h2>

        <div class="subsection-constructor">
        

<div class="collapsing-entry method-type-class start-open">


    <h4 class="js-collapse-title" id="Queue">new Queue<span class="signature">(<span class="signature-args">input</span>)</span><span class="type-signature"></span></h4>


<div class="collapse-details js-collapse-details">


  

  <div class="description">
    <p>Creates an instance of Queue with the given options</p>
  </div>




<table class="method-info-table">

  

  

  


  <tr>
    <th>Parameters</th>
    <td>
      

<table class="params">
    

        <tr>
            
              <td class="name">input</td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>



            

            
                
                

                

                
                
                  <span class="param-attributes">(Optional)</span>
                  
            
            </td>

            
              <td></td>
            

            <tr>
              <td></td>
              <td class="description last">
                
                
                  <h6>Properties</h6>
                  

<table class="params">
    

        <tr>
            
              <td class="name">maxRetentionTime</td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>



            

            
                
                

                

                
                
                  <span class="param-attributes">(Optional)</span>
                  
            
            </td>

            
                <td class="default">
                
                    5 days
                
                </td>
            

            <tr>
              <td></td>
              <td class="description last">
                <p>Time for which a queued
request will live in the queue(irrespective of failed/success of replay).</p>
                
              </td>
            </tr>
        </tr>

    

        <tr>
            
              <td class="name">callbacks</td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>



            

            
                
                

                

                
                
                  <span class="param-attributes">(Optional)</span>
                  
            
            </td>

            
                <td class="default">
                
                </td>
            

            <tr>
              <td></td>
              <td class="description last">
                <p>Callbacks for successfull/failed
replay of a request as well as modifying before enqueue/dequeue-ing.</p>
                
                  <h6>Properties</h6>
                  

<table class="params">
    

        <tr>
            
              <td class="name">replayDidSucceed</td>
            

            <td class="type">
            
                
<span class="param-type">Fuction</span>



            

            
                
                

                

                
                
                  <span class="param-attributes">(Optional)</span>
                  
            
            </td>

            
              <td></td>
            

            <tr>
              <td></td>
              <td class="description last">
                <p>Invoked with params (hash:string, response:Response) after a request is
successfully replayed.</p>
                
              </td>
            </tr>
        </tr>

    

        <tr>
            
              <td class="name">replayDidFail</td>
            

            <td class="type">
            
                
<span class="param-type">Fuction.&lt;string></span>



            

            
                
                

                

                
                
                  <span class="param-attributes">(Optional)</span>
                  
            
            </td>

            
              <td></td>
            

            <tr>
              <td></td>
              <td class="description last">
                <p>Invoked with param (hash:string) after a replay attempt has failed.</p>
                
              </td>
            </tr>
        </tr>

    

        <tr>
            
              <td class="name">requestWillEnqueue</td>
            

            <td class="type">
            
                
<span class="param-type">Fuction.&lt;Object></span>



            

            
                
                

                

                
                
                  <span class="param-attributes">(Optional)</span>
                  
            
            </td>

            
              <td></td>
            

            <tr>
              <td></td>
              <td class="description last">
                <p>Invoked with param (reqData:Object) before a failed request is saved to
the queue. Use this to modify the saved data.</p>
                
              </td>
            </tr>
        </tr>

    

        <tr>
            
              <td class="name">requestWillDequeue</td>
            

            <td class="type">
            
                
<span class="param-type">Fuction.&lt;Object></span>



            

            
                
                

                

                
                
                  <span class="param-attributes">(Optional)</span>
                  
            
            </td>

            
              <td></td>
            

            <tr>
              <td></td>
              <td class="description last">
                <p>Invoked with param (reqData:Object) before a failed request is retrieved
from the queue. Use this to modify the data before the request is replayed.</p>
                
              </td>
            </tr>
        </tr>

    
</table>

                
              </td>
            </tr>
        </tr>

    

        <tr>
            
              <td class="name">queueName</td>
            

            <td class="type">
            
                
<span class="param-type">string</span>



            

            
                
                

                

                
                
                  <span class="param-attributes">(Optional)</span>
                  
            
            </td>

            
                <td class="default">
                
                </td>
            

            <tr>
              <td></td>
              <td class="description last">
                <p>Queue name inside db in which
requests will be queued.</p>
                
              </td>
            </tr>
        </tr>

    

        <tr>
            
              <td class="name">broadcastChannel</td>
            

            <td class="type">
            
                
<span class="param-type">BroadcastChannel</span>



            

            
                
                

                

                
                
                  <span class="param-attributes">(Optional)</span>
                  
            
            </td>

            
                <td class="default">
                
                </td>
            

            <tr>
              <td></td>
              <td class="description last">
                <p>BroadcastChannel
which will be used to publish messages when the request will be queued.</p>
                
              </td>
            </tr>
        </tr>

    
</table>

                
              </td>
            </tr>
        </tr>

    
</table>

    </td>
  </tr>


<!--
<tr>
<th>Details</th>
<td>


<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>

</td>
</tr>
-->













</table>

</div>

</div>

        </div>
      

    

    

    

     

    

    

    
        <h2 class="subsection-title">Instance Methods</h2>

        <div class="subsection-methods">
        
            

<div class="collapsing-entry method-type-function ">


    <h4 class="js-collapse-title" id="getResponse"><span class="this">this.</span>getResponse<span class="signature">(<span class="signature-args">id</span>)</span><span class="type-signature"> <span class="return-arrow">&rarr;</span> Object</span></h4>


<div class="collapse-details js-collapse-details">


  

  <div class="description">
    <p>Sets the dbName, which is used to store the queue and requests
defaults to bgQueueSyncDB.</p>
  </div>




<table class="method-info-table">

  

  

  


  <tr>
    <th>Parameters</th>
    <td>
      

<table class="params">
    

        <tr>
            
              <td class="name">id</td>
            

            <td class="type">
            
                
<span class="param-type">String</span>



            

            
            </td>

            
              <td></td>
            

            <tr>
              <td></td>
              <td class="description last">
                <p>The ID of the request.</p>
                
              </td>
            </tr>
        </tr>

    
</table>

    </td>
  </tr>


<!--
<tr>
<th>Details</th>
<td>


<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>

</td>
</tr>
-->












  <tr>
  <th>Returns</th>
  <td>
  
          



<span class="param-type">Object</span>





<div class="param-desc">
    <p>Fetched response of the request.</p>
</div>


      
  </td>
  </tr>


</table>

</div>

</div>

        
            

<div class="collapsing-entry method-type-function ">


    <h4 class="js-collapse-title" id="pushIntoQueue"><span class="this">this.</span>pushIntoQueue<span class="signature">(<span class="signature-args">input</span>)</span><span class="type-signature"> <span class="return-arrow">&rarr;</span> Promise</span></h4>


<div class="collapse-details js-collapse-details">


  

  <div class="description">
    <p>This function pushes a given request into the IndexedDb Queue.</p>
  </div>




<table class="method-info-table">

  

  

  


  <tr>
    <th>Parameters</th>
    <td>
      

<table class="params">
    

        <tr>
            
              <td class="name">input</td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>



            

            
            </td>

            
              <td></td>
            

            <tr>
              <td></td>
              <td class="description last">
                
                
                  <h6>Properties</h6>
                  

<table class="params">
    

        <tr>
            
              <td class="name">request</td>
            

            <td class="type">
            
                
<span class="param-type">Request</span>



            

            
            </td>

            
              <td></td>
            

            <tr>
              <td></td>
              <td class="description last">
                <p>The request which is to be queued</p>
                
              </td>
            </tr>
        </tr>

    
</table>

                
              </td>
            </tr>
        </tr>

    
</table>

    </td>
  </tr>


<!--
<tr>
<th>Details</th>
<td>


<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>

</td>
</tr>
-->












  <tr>
  <th>Returns</th>
  <td>
  
          



<span class="param-type">Promise</span>





<div class="param-desc">
    <p>Promise which resolves when the request is pushed in
the queue.</p>
</div>


      
  </td>
  </tr>


</table>

</div>

</div>

        
            

<div class="collapsing-entry method-type-function ">


    <h4 class="js-collapse-title" id="replayRequests"><span class="this">this.</span>replayRequests<span class="signature">(<span class="signature-args"></span>)</span><span class="type-signature"> <span class="return-arrow">&rarr;</span> Promise</span></h4>


<div class="collapse-details js-collapse-details">


  

  <div class="description">
    <p>Replays all the requests in the queue, this can be used for custom timing
of replaying requests may be in an environment where sync event is not
supported.</p>
  </div>




<table class="method-info-table">

  

  

  



<!--
<tr>
<th>Details</th>
<td>


<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>

</td>
</tr>
-->












  <tr>
  <th>Returns</th>
  <td>
  
          



<span class="param-type">Promise</span>





<div class="param-desc">
    <p>A listener for when the requests have been replayed.</p>
</div>


      
  </td>
  </tr>


</table>

</div>

</div>

        
        </div>